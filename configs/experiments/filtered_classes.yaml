# 过滤类别实验配置
# 只训练样本量 >= 100 的类别，排除 5 个极稀有类

experiment:
  name: "filtered_classes"
  description: "只训练样本充足的8个类别"

data:
  root: "datasets/shezhenv3-coco"
  batch_size: 4
  num_workers: 2
  label_offset: 1
  normalize: false
  resize_in_dataset: false
  image_size: [800, 800]
  # 过滤类别：只保留样本量 >= 100 的类别
  class_filter:
    - baitaishe      # 5040
    - hongdianshe    # 3653
    - liewenshe      # 1886
    - chihenshe      # 1482
    - hongshe        # 1466
    - huangtaishe    # 1119
    - pangdashe      # 689
    - botaishe       # 581
  # 排除的类别:
  # - shenquao       # 495
  # - xinfeiao       # 372
  # - gandanao       # 292
  # - shoushe        # 285
  # - huataishe      # 283
  # - zishe          # 231
  # - piweiao        # 186
  # - heitaishe      # 122
  # 排除的类别:
  # - jiankangshe (21)
  # - gandantu (9)
  # - unknown_21 (7)
  # - shenqutu (2)
  # - xinfeitu (2)

model:
  backbone: "resnet50"
  pretrained: true
  neck: "fpn"
  head: "faster_rcnn_v2"
  # num_classes 会自动计算为 17 (16类 + 1背景)

train:
  epochs: 30
  lr: 0.001
  weight_decay: 0.0001
  lr_scheduler: "warmup_cosine"
  warmup_epochs: 3
  early_stop_patience: 8
  early_stop_min_delta: 0.001
  early_stop_metric: "mAP"

loss:
  type: "class_balanced_focal"
  focal_gamma: 2.0

sampler:
  type: "default"

augmentation:
  type: "basic"
  horizontal_flip: true
  brightness_contrast: true
  hue_saturation: true
  gauss_noise: true
